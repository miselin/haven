
pub impure fn malloc(i32 size) -> i8*;
pub impure fn free(i8 *ptr) -> i32;
pub impure fn printf(str fmt, *) -> i32;
pub impure fn strcpy(i8 *dest, i8 *src) -> i8*;

pub impure fn main() -> i32 {
    let mut s = as<i8*>(malloc(256));
    defer { if s != nil { free(s); }; };

    strcpy(s, "hello, World!");

    printf("before: %s\n", s);

    s[0] = 'H';

    printf("result: %s\n", s);

    0
}
